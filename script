@echo off

REM disable guest
net user guest /active:no

REM delete users
set /p "userTest=Enter authorized users: "
:moreUsers
	if "%userTest%" == "done" (
		echo users completed
	) else (
		net localgroup Users %userTest% /add
		net localgroup Administrators %userTest% /delete
		set "all_chars=ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*90_+[]{}|;:,.<>?`~"
		set "newPass="
		for /l %%i in (1, 1, 16) do (
			set /a "random_index=!random! %% 94"
			for %%j in (!random_index!) do (
				set "char=!all_chars!:~%%j,1!"
				set "password=!password!!char!"
			)
		)
		net user %userTest% %newPass%
		goto :moreUsers
	)

REM enable firewall
netsh advfirewall set allprofiles state on

REM enable updates
reg add "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Auto Update" /v AUOptions /t REG_DWORD /d 4 /f

pause
